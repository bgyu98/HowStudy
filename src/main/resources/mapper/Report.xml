<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.demo.dao.ReportDAO">
	<insert id="insertReport" parameterType="ReportVO">
		insert into REPORT
		(rNum, rClass, mID, rTitle, rOpponent, rDate, rReason, rFile, status)
		values(nextval(sq_REPORT_SEQ), #{rClass}, #{mId}, #{rTitle},
		#{rOpponent}, NOW(), #{rReason}, #{rFile} , 'N')
	</insert>

	<!-- 관리자 신고 승인 -->
	<update id="updateReport" parameterType="ReportVO">
		UPDATE REPORT SET status='Y' WHERE rNum=#{rNum}

	</update>
	<!-- 글 리스트 출력 -->
	<select id="getReportList" parameterType="ReportVO"
		resultType="ReportVO">
		SELECT *
		FROM REPORT
		ORDER BY rNUM DESC
		LIMIT 7
	</select>

	<!-- 관리자 신고 리스트 -->
	<select id="manageReportList" parameterType="ReportVO"
		resultType="ReportVO">
		SELECT *
		FROM REPORT
		ORDER BY rNUM DESC
		LIMIT #{pageStart}, #{perPageNum}

	</select>

	<!-- <select id="manageReportList" parameterType="ReportVO" resultType="ReportVO"> 
		SELECT * FROM REPORT WHERE rNum in (SELECT rNum FROM (SELECT @ROWNUM:=@ROWNUM+1 
		AS rowNum, rNum FROM (select @ROWNUM:=@ROWNUM+1, rNum from REPORT <where> 
		<if test="rNUM != null"> rNum = #{rNum} </if> </where> order by rNum desc)) 
		<![CDATA[WHERE rowNum>=#{rowStart} AND rowNum<=#{rowEnd})]]> ORDER BY rNum 
		DESC </select> -->

	<!-- 관리자 신고상세 -->
	<select id="getReport" parameterType="ReportVO"
		resultType="ReportVO">
		SELECT *
		FROM REPORT
		Where rNUM = #{rNUM}
	</select>

	<!-- 상품목록 카운트 -->
	<select id="listCount" parameterType="ReportVO" resultType="int">
		SELECT COUNT(rNum)
		FROM REPORT
		<where>
			<if test="rNum != null">
				rNum = #{rNum}
			</if>
		</where>
	</select>

</mapper>